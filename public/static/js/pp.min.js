function hex_md5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}function b64_md5(e){return binl2b64(core_md5(str2binl(e),e.length*chrsz))}function str_md5(e){return binl2str(core_md5(str2binl(e),e.length*chrsz))}function hex_hmac_md5(e,t){return binl2hex(core_hmac_md5(e,t))}function b64_hmac_md5(e,t){return binl2b64(core_hmac_md5(e,t))}function str_hmac_md5(e,t){return binl2str(core_hmac_md5(e,t))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function verifieredirect(e){document.location.href=e}function core_md5(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,n=-271733879,o=-1732584194,s=271733878,r=0;e.length>r;r+=16){var a=i,l=n,c=o,u=s;i=md5_ff(i,n,o,s,e[r+0],7,-680876936),s=md5_ff(s,i,n,o,e[r+1],12,-389564586),o=md5_ff(o,s,i,n,e[r+2],17,606105819),n=md5_ff(n,o,s,i,e[r+3],22,-1044525330),i=md5_ff(i,n,o,s,e[r+4],7,-176418897),s=md5_ff(s,i,n,o,e[r+5],12,1200080426),o=md5_ff(o,s,i,n,e[r+6],17,-1473231341),n=md5_ff(n,o,s,i,e[r+7],22,-45705983),i=md5_ff(i,n,o,s,e[r+8],7,1770035416),s=md5_ff(s,i,n,o,e[r+9],12,-1958414417),o=md5_ff(o,s,i,n,e[r+10],17,-42063),n=md5_ff(n,o,s,i,e[r+11],22,-1990404162),i=md5_ff(i,n,o,s,e[r+12],7,1804603682),s=md5_ff(s,i,n,o,e[r+13],12,-40341101),o=md5_ff(o,s,i,n,e[r+14],17,-1502002290),n=md5_ff(n,o,s,i,e[r+15],22,1236535329),i=md5_gg(i,n,o,s,e[r+1],5,-165796510),s=md5_gg(s,i,n,o,e[r+6],9,-1069501632),o=md5_gg(o,s,i,n,e[r+11],14,643717713),n=md5_gg(n,o,s,i,e[r+0],20,-373897302),i=md5_gg(i,n,o,s,e[r+5],5,-701558691),s=md5_gg(s,i,n,o,e[r+10],9,38016083),o=md5_gg(o,s,i,n,e[r+15],14,-660478335),n=md5_gg(n,o,s,i,e[r+4],20,-405537848),i=md5_gg(i,n,o,s,e[r+9],5,568446438),s=md5_gg(s,i,n,o,e[r+14],9,-1019803690),o=md5_gg(o,s,i,n,e[r+3],14,-187363961),n=md5_gg(n,o,s,i,e[r+8],20,1163531501),i=md5_gg(i,n,o,s,e[r+13],5,-1444681467),s=md5_gg(s,i,n,o,e[r+2],9,-51403784),o=md5_gg(o,s,i,n,e[r+7],14,1735328473),n=md5_gg(n,o,s,i,e[r+12],20,-1926607734),i=md5_hh(i,n,o,s,e[r+5],4,-378558),s=md5_hh(s,i,n,o,e[r+8],11,-2022574463),o=md5_hh(o,s,i,n,e[r+11],16,1839030562),n=md5_hh(n,o,s,i,e[r+14],23,-35309556),i=md5_hh(i,n,o,s,e[r+1],4,-1530992060),s=md5_hh(s,i,n,o,e[r+4],11,1272893353),o=md5_hh(o,s,i,n,e[r+7],16,-155497632),n=md5_hh(n,o,s,i,e[r+10],23,-1094730640),i=md5_hh(i,n,o,s,e[r+13],4,681279174),s=md5_hh(s,i,n,o,e[r+0],11,-358537222),o=md5_hh(o,s,i,n,e[r+3],16,-722521979),n=md5_hh(n,o,s,i,e[r+6],23,76029189),i=md5_hh(i,n,o,s,e[r+9],4,-640364487),s=md5_hh(s,i,n,o,e[r+12],11,-421815835),o=md5_hh(o,s,i,n,e[r+15],16,530742520),n=md5_hh(n,o,s,i,e[r+2],23,-995338651),i=md5_ii(i,n,o,s,e[r+0],6,-198630844),s=md5_ii(s,i,n,o,e[r+7],10,1126891415),o=md5_ii(o,s,i,n,e[r+14],15,-1416354905),n=md5_ii(n,o,s,i,e[r+5],21,-57434055),i=md5_ii(i,n,o,s,e[r+12],6,1700485571),s=md5_ii(s,i,n,o,e[r+3],10,-1894986606),o=md5_ii(o,s,i,n,e[r+10],15,-1051523),n=md5_ii(n,o,s,i,e[r+1],21,-2054922799),i=md5_ii(i,n,o,s,e[r+8],6,1873313359),s=md5_ii(s,i,n,o,e[r+15],10,-30611744),o=md5_ii(o,s,i,n,e[r+6],15,-1560198380),n=md5_ii(n,o,s,i,e[r+13],21,1309151649),i=md5_ii(i,n,o,s,e[r+4],6,-145523070),s=md5_ii(s,i,n,o,e[r+11],10,-1120210379),o=md5_ii(o,s,i,n,e[r+2],15,718787259),n=md5_ii(n,o,s,i,e[r+9],21,-343485551),i=safe_add(i,a),n=safe_add(n,l),o=safe_add(o,c),s=safe_add(s,u)}return[i,n,o,s]}function md5_cmn(e,t,i,n,o,s){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(n,s)),o),i)}function md5_ff(e,t,i,n,o,s,r){return md5_cmn(t&i|~t&n,e,t,o,s,r)}function md5_gg(e,t,i,n,o,s,r){return md5_cmn(t&n|i&~n,e,t,o,s,r)}function md5_hh(e,t,i,n,o,s,r){return md5_cmn(t^i^n,e,t,o,s,r)}function md5_ii(e,t,i,n,o,s,r){return md5_cmn(i^(t|~n),e,t,o,s,r)}function core_hmac_md5(e,t){var i=str2binl(e);i.length>16&&(i=core_md5(i,e.length*chrsz));for(var n=Array(16),o=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],o[s]=1549556828^i[s];var r=core_md5(n.concat(str2binl(t)),512+t.length*chrsz);return core_md5(o.concat(r),640)}function safe_add(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i}function bit_rol(e,t){return e<<t|e>>>32-t}function str2binl(e){for(var t=[],i=(1<<chrsz)-1,n=0;e.length*chrsz>n;n+=chrsz)t[n>>5]|=(e.charCodeAt(n/chrsz)&i)<<n%32;return t}function binl2str(e){for(var t="",i=(1<<chrsz)-1,n=0;32*e.length>n;n+=chrsz)t+=String.fromCharCode(e[n>>5]>>>n%32&i);return t}function binl2hex(e){for(var t=hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",n=0;4*e.length>n;n++)i+=t.charAt(15&e[n>>2]>>8*(n%4)+4)+t.charAt(15&e[n>>2]>>8*(n%4));return i}function binl2b64(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",n=0;4*e.length>n;n+=3)for(var o=(255&e[n>>2]>>8*(n%4))<<16|(255&e[n+1>>2]>>8*((n+1)%4))<<8|255&e[n+2>>2]>>8*((n+2)%4),s=0;4>s;s++)i+=8*n+6*s>32*e.length?b64pad:t.charAt(63&o>>6*(3-s));return i}function base64encode(e){var t,i,n,o,s,r;for(n=e.length,i=0,t="";n>i;){if(o=255&e.charCodeAt(i++),i==n){t+=base64EncodeChars.charAt(o>>2),t+=base64EncodeChars.charAt((3&o)<<4),t+="==";break}if(s=e.charCodeAt(i++),i==n){t+=base64EncodeChars.charAt(o>>2),t+=base64EncodeChars.charAt((3&o)<<4|(240&s)>>4),t+=base64EncodeChars.charAt((15&s)<<2),t+="=";break}r=e.charCodeAt(i++),t+=base64EncodeChars.charAt(o>>2),t+=base64EncodeChars.charAt((3&o)<<4|(240&s)>>4),t+=base64EncodeChars.charAt((15&s)<<2|(192&r)>>6),t+=base64EncodeChars.charAt(63&r)}return t}function base64decode(e){var t,i,n,o,s,r,a;for(r=e.length,s=0,a="";r>s;){do t=base64DecodeChars[255&e.charCodeAt(s++)];while(r>s&&-1==t);if(-1==t)break;do i=base64DecodeChars[255&e.charCodeAt(s++)];while(r>s&&-1==i);if(-1==i)break;a+=String.fromCharCode(t<<2|(48&i)>>4);do{if(n=255&e.charCodeAt(s++),61==n)return a;n=base64DecodeChars[n]}while(r>s&&-1==n);if(-1==n)break;a+=String.fromCharCode((15&i)<<4|(60&n)>>2);do{if(o=255&e.charCodeAt(s++),61==o)return a;o=base64DecodeChars[o]}while(r>s&&-1==o);if(-1==o)break;a+=String.fromCharCode((3&n)<<6|o)}return a}function utf16to8(e){var t,i,n,o;for(t="",n=e.length,i=0;n>i;i++)o=e.charCodeAt(i),o>=1&&127>=o?t+=e.charAt(i):o>2047?(t+=String.fromCharCode(224|15&o>>12),t+=String.fromCharCode(128|63&o>>6),t+=String.fromCharCode(128|63&o>>0)):(t+=String.fromCharCode(192|31&o>>6),t+=String.fromCharCode(128|63&o>>0));return t}function utf8to16(e){var t,i,n,o,s,r;for(t="",n=e.length,i=0;n>i;)switch(o=e.charCodeAt(i++),o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(i-1);break;case 12:case 13:s=e.charCodeAt(i++),t+=String.fromCharCode((31&o)<<6|63&s);break;case 14:s=e.charCodeAt(i++),r=e.charCodeAt(i++),t+=String.fromCharCode((15&o)<<12|(63&s)<<6|(63&r)<<0)}return t}function getCookie(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(e,t,i){var n=new Date;n.setDate(n.getDate()+i),document.cookie=e+"="+escape(t)+(null==i?"":";expires="+n.toGMTString())}var site_url="undefined"==typeof hiui?"https://user.hiwifi.com/":hiui.webSite.getUserDomain(),store_url="undefined"==typeof hiui?"http://store.hiwifi.com/":hiui.webSite.getStoreDomain(),offcial_url="undefined"==typeof hiui?"http://www.hiwifi.com/":hiui.webSite.getWebDomain(),bbs_url="undefined"==typeof hiui?"http://bbs.hiwifi.com/":hiui.webSite.getBbsDomain(),products_url=offcial_url+"/products/",services_url=offcial_url+"/services/",mycross=site_url,hexcase=0,b64pad="",chrsz=8,base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],passportObj={version:"0.1",appId:1e3,autoFocus:!1,rootElement:!1,panelElement:!1,hiddeElement:!1,useridHandle:!1,passwdHandle:!1,pcookieHandle:!1,msgHandle:!1,userid:"",domain:"",cookie:!1,usePost:!1,forwardUrl:"",loginRedirectUrl:"",logoutRedirectUrl:"",eTimeout:!1,apps:[],counter:0,crossDomainCount:0,extralinks:'<span class="pipe">|</span><a href="http://store.hiwifi.com/flow.php">购物车</a><span class="pipe">|</span><a href="http://store.hiwifi.com/user.php?act=anony_order">我的订单</a><span class="pipe">|</span><a href="http://app.hiwifi.com/" target="_blank">云平台</a><span class="pipe">|</span><a href="http://4006024680.com/" target="_blank">路由器后台</a>',$:function(e){return document.getElementById(e)},showMsg:function(e){"object"==typeof this.msgHandle&&(this.msgHandle.innerHTML=e)},getDomain:function(){var e=document.domain.split("."),t=e.length;return 2==t?document.domain:e[t-2]+"."+e[t-1]},appendChild:function(e,t){e.appendChild(t)},createForm:function(e,t){null==t&&(t="none"),this.removeNode(e);var i=document.createElement("form");return i.height=0,i.width=0,i.style.display=t,i.name=e,i.id=e,this.appendChild(document.body,i),document.forms[e].name=e,i.addInput=function(e,t,i){null==i&&(i="text");var n=this.getElementsByTagName("input")[e];n&&this.removeChild(n),n=document.createElement("input"),this.appendChild(n),n.id=e,n.name=e,n.type=i,n.value=t},i},_docodeLogin:function(e,t,i){if(this.usePost){var n=this.createForm("login_form");n.method="post",n.action=mycross+"sso/login?method=1",n.target="loginframe",n.addInput("userid",escape(e),"hidden"),n.addInput("passwd",hex_md5(t),"hidden"),n.addInput("p",i,"hidden"),n.addInput("domain",escape(this.domain),"hidden"),n.submit()}else{var o=new Date,s=o.getTime(),r=mycross+"passport/codelogin?userid="+escape(e)+"&passwd="+t+"&p="+i+"&domain="+escape(this.domain)+"&method=2"+"&t="+s,a=document.createElement("script");a.type="text/javascript",a.src=r,a.onreadystatechange=function(){},this.panelElement.appendChild(a)}return!1},_doLogin:function(e,t,i){if(this.usePost){var n=this.createForm("login_form");n.method="post",n.action=mycross+"/sso/login?method=1",n.target="loginframe",n.addInput("userid",escape(e),"hidden"),n.addInput("passwd",hex_md5(t),"hidden"),n.addInput("p",i,"hidden"),n.addInput("domain",escape(this.domain),"hidden"),n.submit()}else{var o=new Date,s=o.getTime(),r=mycross+"/sso/login?userid="+escape(e)+"&passwd="+hex_md5(t)+"&p="+i+"&domain="+escape(this.domain)+"&method=2"+"&t="+s,a=document.createElement("script");a.type="text/javascript",a.src=r,a.onreadystatechange=function(){},this.panelElement.appendChild(a)}return!1},excuteScript:function(e,t){this.removeNode(e);var i=document.getElementsByTagName("head")[0],n=document.createElement("script");n.src=t+"&t="+(new Date).getTime(),n.id=e,n.type="text/javascript",i.appendChild(n)},removeNode:function(e){try{"string"==typeof e&&(e=document.getElementById(e)),e.parentNode.removeChild(e)}catch(t){}},loginProc:function(e){if(clearTimeout(this.eTimeout),this.eTimeout=!1,""==e)return this.loginFailMsg({recode:11}),void 0;if(0!=e.recode)return this._drawLoginPanel(),this.loginFailMsg(e),void 0;var t=e.crossdomainurllist;if(this.crossDomainCount=t.length,0==t.length){if(""!=this.loginRedirectUrl)return document.location.href=this.loginRedirectUrl,void 0;if(this.parseCookie(),this.cookie&&""!=this.cookie.userid)return this.drawUserPanel(),void 0}this.eTimeout=setTimeout(function(){passportObj.loginCrossDomainProc()},2e4),this.counter=0;for(var i=0;t.length>i;i++)id=i+1,url=t[i]+"&scriptId="+id,this.excuteScript(id,url)},loginCrossDomainCallback:function(e){this.counter++,this.removeNode("scriptId"+e.scriptId),this.counter==this.crossDomainCount&&(clearTimeout(this.eTimeout),this.eTimeout=!1,setTimeout(function(){passportObj.loginFinish()},10))},loginFinish:function(){return""!=this.loginRedirectUrl?(document.location.href=this.loginRedirectUrl,void 0):(this.parseCookie(),this.cookie&&""!=this.cookie.userid?(this.drawUserPanel(),void 0):void 0)},loginCrossDomainProc:function(){clearTimeout(this.eTimeout),this.eTimeout=!1,this.counter>=this.crossDomainCount&&setTimeout(function(){passportObj.loginFinish()},10)},logoutCrossDomainCallback:function(e){this.counter++,this.removeNode("scriptId"+e.scriptId),this.counter==this.crossDomainCount&&(clearTimeout(this.eTimeout),this.eTimeout=!1,setTimeout(function(){passportObj.logoutFinish()},10))},logoutFinish:function(){return this.parseCookie(),this.cookie&&this.cookie.userid?(this.drawUserPanel(),void 0):""!=this.logoutRedirectUrl?(location.href=this.logoutRedirectUrl,void 0):(this._drawLoginPanel(),void 0)},logoutCrossDomainProc:function(){clearTimeout(this.eTimeout),this.eTimeout=!1,this.counter>=this.crossDomainCount&&setTimeout(function(){passportObj.logoutFinish()},10)},loginFailMsg:function(e){return"1"==e.recode?(this.showMsg("电子邮箱格式不正确"),void 0):"2"==e.recode?(this.showMsg("该用户不存在"),void 0):"3"==e.recode?(e.msg===void 0?this.showMsg("用户或密码错误"):this.showMsg(e.msg),void 0):"4"==e.recode?(this.showMsg("该用户被禁止登录"),void 0):"5"==e.recode?(this.showMsg("该用户不存在"),void 0):"6"==e.recode?(this.showMsg("该用户尚未激活"),setTimeout(verifieredirect(e.redirecturl),1e3),void 0):"7"==e.recode?(this.showMsg("登录超时，您的网络较慢或登录服务出现了故障"),void 0):"8"==e.recode?(this.showMsg("退出超时，您的网络较慢或登录服务出现了故障"),void 0):"9"==e.recode?(this.showMsg("通行证暂停服务，稍后登录"),void 0):"10"==e.recode?(this.showMsg("非认证站点请求，系统中止登录处理"),void 0):"12"==e.recode?(this.showMsg("请您使用邮箱或手机号登录!"),void 0):(this.showMsg("未知错误，请您稍后重试"),void 0)},logoutProc:function(e){if(clearTimeout(this.eTimeout),this.eTimeout=!1,""!=e&&0==e.recode){var t=e.crossdomainurllist;if(this.crossDomainCount=t.length,0==t.length){if(this.parseCookie(),this.cookie&&this.cookie.userid)return this.drawUserPanel(),void 0;if(""!=this.logoutRedirectUrl)return location.href=this.logoutRedirectUrl,void 0;this._drawLoginPanel()}this.eTimeout=setTimeout(function(){passportObj.logoutCrossDomainProc()},2e4),this.counter=0;for(var i=0;t.length>i;i++)id=i+1,url=t[i]+"&scriptId="+id,this.excuteScript(id,url)}},doLogin:function(){var e=this.userid=this.useridHandle.value,t=this.passwdHandle.value;return""==e?(this.showMsg("请输入极客通行证账户名"),this.useridHandle.focus(),!1):""==t?(this.passwdHandle.focus(),!1):(this.drawWaiting("正在登录……"),this.eTimeout=setTimeout(function(){passportObj.loginIntervalProc()},2e4),this._doLogin(e,t,this.pcookieHandle.checked?1:0))},loginIntervalProc:function(){clearTimeout(this.eTimeout),this.eTimeout=!1,this._drawLoginPanel(),this.loginFailMsg({recode:7})},logoutIntervalProc:function(){clearTimeout(this.eTimeout),this.eTimeout=!1,this._drawLoginPanel(),this.loginFailMsg({recode:8})},doLogout:function(){this._doLogout(),this.eTimeout=setTimeout(function(){passportObj.logoutIntervalProc()},2e4)},_doLogout:function(){var e=new Date;this.drawWaiting("正在退出通行证");var t=document.createElement("script");t.src=mycross+"sso/logout?t="+e.getTime(),t.type="text/javascript",this.panelElement.appendChild(t)},init:function(e){this.domain=this.getDomain(),this.rootElement=e,this.rootElement.innerHTML='<div style="display:none"><iframe src="javascript:false;" name="loginframe" width="0" height="0"></iframe></div><div></div>',this.hiddeElement=this.rootElement.childNodes[0],this.panelElement=this.rootElement.childNodes[1],this.parseCookie(),this.forwardUrl=location.href},drawPanel:function(e){if("object"==typeof e)if(this.init(e),this.cookie&&""!=this.cookie){if(""!=this.loginRedirectUrl)return location.href=this.loginRedirectUrl,void 0;this.drawUserPanel()}else{if(""!=this.logoutRedirectUrl)return location.href=this.logoutRedirectUrl,void 0;this._drawLoginPanel()}},drawUserPanel:function(){},_drawLoginPanel:function(){this.drawLoginPanel();for(var e=this.panelElement.getElementsByTagName("input"),t=0;e.length>t;t++)"userid"==e[t].name&&(this.useridHandle=e[t],this.useridHandle.value=this.userid,this.useridHandle.setAttribute("maxLength",64),this.useridHandle.setAttribute("placeholder","邮箱/手机号/用户名")),"passwd"==e[t].name&&(this.passwdHandle=e[t],this.passwdHandle.setAttribute("maxLength",64)),"persistentcookie"==e[t].name&&(this.pcookieHandle=e[t],this.pcookieHandle.onclick=function(){if(0!=passportObj.pcookieHandle.checked){var e=window.confirm("为了您的信息安全，请不要在网吧或公用电脑上使用此功能！");0==e&&(passportObj.pcookieHandle.checked=!1)}});this.msgHandle=document.getElementById("_msg"),this.autoFocus&&(this.useridHandle.value?this.passwdHandle.focus():this.useridHandle.focus())},drawLoginPanel:function(){},drawWaiting:function(){},parseCookie:function(){this.cookie=!1;var e=getCookie("ppinfo");if(""!=e){var t=e.split("|")[1];""!=t&&this._parseCookie(utf8to16(base64decode(t)))}},_parseCookie:function(e){var t,i;for(this.cookie={},t=0,i=e.indexOf(":",t);-1!=i;){var n,o,s;if(n=e.substring(t,i),lenEnd_offset=e.indexOf(":",i+1),-1==lenEnd_offset)break;if(o=parseInt(e.substring(i+1,lenEnd_offset)),s=e.substr(lenEnd_offset+1,o),"|"!=e.charAt(lenEnd_offset+1+o))break;this.cookie[n]=s,t=lenEnd_offset+2+o,i=e.indexOf(":",t)}}};